class KitChoices extends HTMLElement{constructor(){super()}get itemsSelected(){const a=this.shadow.querySelectorAll("input[type=\"radio\"]:checked"),b=Array.from(a).map(a=>a.value);return b}connectedCallback(){const a=document.querySelector("template#__KITDATA__");this.items=JSON.parse(a.innerHTML),this.shadow=this.attachShadow({mode:"open"}),this.shadow.appendChild(this.style()),this.shadow.appendChild(this.render())}getItemChoices(a){const b=Math.random().toString(36).substring(2,7),c=document.createElement("div");c.classList.add("kit-item-choices"),c.innerHTML+="<div style='margin-top: 5px;'><strong>sabor:</strong></div>";const d=document.createElement("div");for(let c in d.classList.add("variations-container"),a){if(!a[c].active)continue;const e=`${a[c].name}-${b}`,f=document.createElement("label");f.innerText=a[c].name,f.setAttribute("for",e);const g=document.createElement("input");g.type="radio",g.id=e,g.name=`radio-variation-${b}`,g.value=a[c].id,g.style.display="none",g.addEventListener("change",()=>{const a=new Event("change");this.dispatchEvent(a)}),d.append(g,f),0>=a[c].stock&&(f.classList.add("disabled"),g.disabled=!0)}return c.append(d),c}getItemInfo(a){const b=document.createElement("div");b.classList.add("kit-item-info");const c=document.createElement("a");c.href=a.url,c.innerText=a.name;const d=document.createElement("small");return d.innerText=`Ref: ${a.sku}`,b.append(c,d,this.getItemChoices(a.variations)),b}render(){const a=document.createElement("div");a.classList.add("kit-choices-container");const b=document.createElement("p");return b.classList.add("title"),b.innerText="Produtos do Kit",a.appendChild(b),this.items.forEach(b=>{const c=document.createElement("div");c.classList.add("item-container");const d=this.getItemInfo(b),e=document.createElement("div");e.classList.add("kit-unit"),e.innerText="1 unidade",c.append(d,e),a.appendChild(c)}),a}style(){const a=document.createElement("style");return a.textContent=`
    .kit-choices-container {
        border: 1px solid gray;
        border-radius: 10px;
    }
    .title {
        text-align: center;
        color: #C30B02;
        font-weight: bold;
    }
    .item-container {
        display: flex;   
        border-top: 1px solid gray;
        padding: 10px; 
    }
    .kit-item-info {
        flex-grow: 1;
    }
    .kit-unit {
        width: 150px;
    }
    .kit-item-info a {
        display: block;
    }
    .variations-container {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
    }
    .variations-container label {
        border: 1px solid gray;
        padding: 2px 5px;
        border-radius: 5px;
        cursor: pointer;
        background-color: white;
        transition: all .5s;
    }
    .variations-container label:not(.disabled):hover {
        transform: scale(1.05);
    }
    .variations-container input:checked + label {
        background-color: #C30B02;
        color: white;
        font-weight: bold;
        border: none;
    }
    .variations-container label.disabled {
        background-color: gray;
        color: rgba(255, 255, 255, 0.2);
        cursor: not-allowed;
        position: relative;
    }
    .variations-container label.disabled:before {
        content: 'FALTA';
        color: red;
        font-size: 12px;
        position: absolute;
        font-weight: bold;
        top: -5%;
        left: 50%;
        transform: rotate(-35deg) translate(-50%, -50%);
    }
`,a}}customElements.define("kit-choices",KitChoices);